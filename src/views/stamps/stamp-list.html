<template>
	<require from="../../components/stamp-grid"></require>
	<require from="../../components/stamps/stamp-editor"></require>
    <require from="../../components/search/search-form"></require>
	<require from="../../components/stamps/stamp-table"></require>
    <require from="../../widgets/paging/paging-toolbar"></require>
    <require from="../../widgets/collapse-panel/collapse-panel"></require>
    <require from="../../widgets/select-picker/select-picker"></require>
	<nav class="navbar navbar-default stamp-grid-nav">
		<form class="navbar-form" role="search">
			<div class="btn-toolbar" role="toolbar">
				<div class="btn-group" role="group">
					<button type="button" class="btn btn-sm btn-default" title="New Stamp" click.trigger="showEditor('create-stamp')">
						<span class="sw-icon-plus"></span>
					</button>
                    <button class="btn btn-sm btn-default" title="${'nav.search'|t}" click.delegate="showEditor('search-panel')">
                        <span class="sw-icon-search"></span>
                    </button>
				</div>

                <div class="btn-group input-group quick-search">
                    <input type="text" class="form-control" value.two-way="searchText" placeholder="Search">
                    <button class="btn btn-sm btn-default" title="Search" click.delegate="sendSearch()">
                        <span class="sw-icon-filter"></span>
                    </button>
                    <button class="btn btn-sm btn-default" title="Clear search" click.delegate="clearSearch()">
                        <span class="sw-icon-cancel"></span>
                    </button>
                </div>

                <div class="btn-group" role="group">
					<button class="btn btn-sm btn-default ${ gridMode ? 'active' : ''}" title="Show as grid" click.delegate="setViewMode('Grid')">
						<span class="sw-icon-gridview"></span>
					</button>
					<button class="btn btn-sm btn-default ${ listMode ? 'active' : ''}" title="Show as list" click.delegate="setViewMode('List')">
						<span class="sw-icon-list"></span>
					</button>
				</div>

                <div class="btn-group" role="group">
                    <button class="btn btn-sm btn-default ${ referenceMode ? 'active' : ''}" disabled.bind="listMode" title="Show reference catalogue numbers" click.delegate="toggleCatalogueNumbers()">
                        <span class="sw-icon-references"></span>
                    </button>
                    <button class="btn btn-sm btn-default" title="${'actions.purchase'|t}" click.delegate="purchase()">
                        <span class="sw-icon-purchased"></span>
                    </button>
                </div>

				<div class="btn-group">

					<button class="btn btn-sm btn-default" click.trigger="toggleSortDirection()">
						<span class="${options.sortDirection === 'asc' ? 'sw-icon-sort-up' : 'sw-icon-sort-down'}"></span>
					</button>
					<button class="btn btn-sm btn-default ${options.sort ? '' : 'disabled'}" title="Clear sort" click.trigger="clearSort()">
						<span class="sw-icon-cancel"></span>
					</button>
                    <div class="dropdown">
                        <button type="button" class="btn btn-default btn-sm dropdown-toggle sort-selector" data-toggle="dropdown">
                            <span class="selector-text">${options.sort.text | defaultValue:'Sort by'}</span>
                            <span class="caret"></span>
                        </button>

                        <ul class="dropdown-menu" role="menu">
                            <li repeat.for="sortCol of sortColumns" click.trigger="$parent.setSort(sortCol)">${sortCol.text}</li>
                        </ul>
                    </div>
				</div>

				<div class="btn-group">
                    <div class="dropdown">
                        <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                            <span class="selector-text">${getFilterText(stampFilter)|t | defaultValue:'filters.filter'|t}</span>
                             <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li repeat.for="filter of filters" click.trigger="$parent.setFilter($index)">${$parent.getFilterText(filter)|t}</li>
                        </ul>
                    </div>
                    <!--
                    <div class="dropdown">
                        <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                            <span class="selector-text">${getFilterText(conditionFilter)|t | defaultValue:'conditionFilters.ALL_STAMPS'|t}</span>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li repeat.for="filter of conditionFilters" click.trigger="$parent.setConditionFilter($index)">${$parent.getFilterText(filter)|t}</li>
                        </ul>
                    </div>
                    -->
				</div>

				<div class="btn-group">
                    <div class="dropdown">
                        <button type="button" class="btn btn-default btn-sm dropdown-toggle result-size-selector" data-toggle="dropdown">
                            <span class="selector-text">${options.$top | defaultValue:'Size'}</span>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li repeat.for="size of pageSizes" click.delegate="$parent.setSize(size)">${size}</li>
                        </ul>
                    </div>
				</div>
			</div>
		</form>

	</nav>
	<div class="container-fluid stamp-content" >
		<div class="row">
			<div class="col-md-12 col-lg-4 sw-editor-container" if.bind="editorShown">
                <collapse-panel collapsed.bind="!editorShown" name="stamp-list-editor-panel" >
                    <stamp-editor if.bind="panelContents === 'stamp-editor'" model.bind="editingStamp"></stamp-editor>
                    <search-form if.bind="panelContents === 'search-panel'"></search-form>
                </collapse-panel>
			</div>
            <div class="col-md-12 ${(editorShown) ? 'col-lg-8' : 'col-lg-12'} full-height">
                <stamp-grid if.bind="gridMode" class="" stamps.bind="stamps"
                            last-selected.bind="lastSelected" edit-id.bind="editingStamp.id" show-catalogue-numbers.bind="referenceMode">
                </stamp-grid>
                <stamp-table if.bind="!gridMode" class="" stamps.bind="stamps" total.bind="pageInfo.total"></stamp-table>
            </div>

		</div>
	</div>
	<div class="sw-fullsize-image" if.bind="imageShown" click.delegate="closeFullSizeImage()">
		<img src.bind="fullSizeImage" error.delegate="closeFullSizeImage()">
	</div>
	<nav class="navbar navbar-default stamp-list-footer">
		<form class="navbar-form" role="footer">
            <paging-toolbar page.bind="pageInfo.active" total.bind="pageInfo.total"></paging-toolbar>
            <div class="btn-toolbar" role="toolbar">
                <div class="results-group">
                    ${'footer.total'|t}: <span class="badge">${pageInfo.active * options.$top + 1} - ${pageInfo.active * options.$top + stamps.length}</span> of <span class="badge">${stampCount}</span>
                </div>
                <div class="selection-group">
                    ${'footer.totalSelected'|t}: <span class="badge">${selectedCount}</span>
                </div>
            </div>
            <div class="report-statistics hidden-xs" role="group">
                <div class="btn-group">
                    <button class="btn btn-xs btn-default statistics-button ${(reportType==='CatalogueValue') ? 'active' : ''}" title="${'footer-statistics.catalogue-value'|t}" click.trigger="setStatistics('CatalogueValue')" role="button">
                        <span class="sw-icon-catalogue"></span>
                    </button>
                    <button class="btn btn-xs btn-default statistics-button ${(reportType==='CostBasis') ? 'active' : ''}" title="${'footer-statistics.purchased'|t}" click.trigger="setStatistics('CostBasis')" role="button">
                        <span class="sw-icon-purchased"></span>
                    </button>
                    <button class="btn btn-xs btn-default statistics-button ${(reportType==='CashValue') ? 'active' : ''}" title="${'footer-statistics.cash-value'|t}" click.trigger="setStatistics('CashValue')" role="button">
                        <span class="sw-icon-cash-value"></span>
                    </button>
                    <input class="value-display" value.bind="reportValue" readonly role="status">
                </div>

            </div>

		</form>
	</nav>


</template>
