<template>
    <require from="../../value-converters/as-enum"></require>
    <require from="../../value-converters/as-currency-formatted"></require>
    <require from="../../value-converters/by-name"></require>
    <require from="../../widgets/select-picker/select-picker"></require>

    <require from="resources/styles/components/stamps/stamp-replacement-table.css"></require>

    <div class="stamp-replacement-table-wrapper">
        <div>
            <div class="form-group form-group-sm">
                <label for="filter-catalogueRef" class="col-sm-3 control-label">${'editor.filtering-catalogue'|t}</label>
                <div class="col-sm-9">
                    <select-picker items.bind="catalogues" disabled.bind="loading" value.two-way="model.filterCatalogueRef"
                                   config.bind="{ id: 'filter-catalogueRef', tabIndex: 0, labelProperty: 'displayName', valueProperty: 'id', caption: 'editor.catalogue-select' }">
                    </select-picker>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label for="replacement-catalogueRef" class="col-sm-3 control-label">${'editor.replacement-catalogue'|t}</label>
                <div class="col-sm-9">
                    <select-picker items.bind="catalogues" disabled.bind="loading" value.two-way="model.replacementCatalogueRef"
                                   config.bind="{ id: 'replacement-catalogueRef', tabIndex: 0, labelProperty: 'displayName', valueProperty: 'id', caption: 'editor.catalogue-select' }">
                    </select-picker>
                </div>
            </div>
            <div>
                <button type="button" class="btn btn-sm btn-primary ${filterReady ? '' : 'disabled'}" disabled.bind="!filterReady" click.delegate="filterStamps()">${'actions.apply'|t}</button>
                <button type="button" class="btn btn-sm" click.delegate="saveAll()">${'actions.save'|t}</button>
                <span class="filtering-message">
                    <label>${ 'footer.filtering-total'|t}</label>
                    ${filteredStamps.length}
                </span>
            </div>
        </div>

        <table class="table table-condensed table-hover">
            <thead>
            <tr>
                <th>${'table.country'|t}</th>
                <th>${'table.description'|t}</th>
                <th>${'table.catalogue-number'|t}</th>
                <th>${'table.condition'|t}</th>
                <th>${'table.catalogue-value'|t}</th>
            </tr>
            </thead>
            <tbody>
            <tr repeat.for="stamp of filteredStamps" click.trigger="select($event, $index)">
                <td class="col-md-3">${ stamp.countryRef | byName:'countries' }</td>
                <td class="col-md-4">${ stamp.rate + ' ' + stamp.description }</td>
                <td class="col-md-1">
                    <span if.bind="editingRow === $index">
                        <input type="text" class="form-control replacement-number-input" tabindex="0" value.bind="editingCatalogueNumber.number">
                    </span>
                    <span if.bind="editingRow !== $index">
                        ${ getReplacementCatalogueNumber(stamp).number }
                    </span>
                </td>
                <td class="col-md-1">
                    <span if.bind="editingRow === $index">
                        <select-picker items.bind="conditions" disabled.bind="loading" value.two-way="editingCatalogueNumber.condition"
                            config.bind="{ id: 'replacement-condition', tabIndex: 0, labelProperty: 'description', valueProperty: 'ordinal', filterSearch: false, caption: 'editor.condition-select' }">
                        </select-picker>
                    </span>
                    <span if.bind="editingRow !== $index">
                        ${ getReplacementCatalogueNumber(stamp).condition|asEnum:'Condition'|t }
                    </span>
                </td>
                <td class="col-md-1">
                    <span if.bind="editingRow === $index">
                        <input type="text" class="form-control replacement-value-input" tabindex="0" value.bind="editingCatalogueNumber.value">
                    </span>
                    <span if.bind="editingRow !== $index">
                        ${ getReplacementCatalogueNumber(stamp).value|asCurrencyFormatted:getCurrencyCode(getReplacementCatalogueNumber(stamp)) }
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</template>
